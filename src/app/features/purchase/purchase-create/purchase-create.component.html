<div class="card">
  <div class="card-body">
    <h1 class="card-title text-success">Registrar Compra</h1>
    <div class="addItem">
      <a type="button" class="btn btn-success" (click)="openModal(addProduct)" title="Agregar Producto">
        Agregar Producto
      </a>
    </div>
    <form [formGroup]="formPurchase" (ngSubmit)="registerPurchase()">
      <div class="row">
        <div class="mb-3 col">
          <label for="purchaseDate" class="form-label">Fecha de compra</label>
          <input type="date" class="form-control" id="purchaseDate" formControlName="purchaseDate">
        </div>
        <div class="mb-3 col">
          <label for="reference" class="form-label">Referencia o factura</label>
          <input type="text" class="form-control" id="reference" formControlName="reference">
        </div>
      </div>
      <table class="table table-striped table-hover">
        <thead>
          <tr>
            <th scope="col">Producto</th>
            <th scope="col">Cantidad</th>
            <th scope="col">Precio Unitario</th>
            <th scope="col">Precio Total</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let pr of newProducts">
            <td>{{ pr.name }}</td>
            <td>{{ pr.units }}</td>
            <td>{{ pr.price }}</td>
            <td>{{ pr.totalCost }}</td>
          </tr>
          <!-- <tr>
            <th>Total</th>
            <td></td>
            <td></td>
            <td></td>
          </tr> -->
        </tbody>
      </table>
      <div class="formButtons">
        <button type="submit" class="btn btn-success">Registrar</button>
        <button class="btn btn-outline-danger" routerLink="../">Cancelar</button>
      </div>
    </form>
  </div>
</div>
<ng-template #addProduct>
  <h2 matDialogTitle>Agregar Producto</h2>
  <mat-dialog-content>
    <form [formGroup]="formAddProduct" (ngSubmit)="registerProduct()">
      <div class="modal-body row">
        <div class="mb-3 col-12">
          <label for="product" class="form-label">Producto</label>
          <select class="form-select" formControlName="product">
            <option [ngValue]="null" disabled>Elija un producto</option>
            <option *ngFor="let prod of products" [ngValue]="prod">
            {{ prod.name }}
            </option>
          </select> 
        </div>
        <div class="mb-3 col">
          <label for="units" class="form-label">Unidades</label>
          <input formControlName="units" type="number" min="1" class="form-control">
        </div>
        <div class="mb-3 col">
          <label for="unitPrice" class="form-label">Precio unitario</label>
          <input formControlName="unitPrice" type="number" min="1" step="any" class="form-control">
        </div>
      </div>
      <mat-dialog-actions class="formButtons">
        <button class="btn btn-success" type="submit">Agregar</button>
        <button type="button" class="btn btn-outline-danger" (click)="closeModal()">Cerrar</button>
      </mat-dialog-actions>
    </form>
  </mat-dialog-content>
</ng-template>


